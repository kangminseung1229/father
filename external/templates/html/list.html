<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>


<style>

    td.grey{
        color : grey;
    }
    td.red{
        color : red;
    }
</style>
</head>

<header th:replace="fragments/cm_top.html :: header('데이터')"></header>

<body>
    
    <span class="fs-4" th:text="|${year}년 ${month}월|"></span>

    <table class="table">
        <thead>
            <tr>
                <th scope="col">날짜</th>
                <th scope="col">납입금</th>
                <th scope="col">소득</th>
                <th scope="col">일별합계</th>
            </tr>
        </thead>
        <tbody>
            <tr th:each=" row : ${list}">
                <td th:text="${#temporals.format(row.datememo,'dd')}" >11</td>
                <td><span th:text="${#numbers.formatInteger(row.companyprice, 0, 'COMMA')}">1,000</span></td>
                <td><span th:text="${#numbers.formatInteger(row.myprice, 0, 'COMMA')}">1,000</span></td>
                <td><span th:text="${#numbers.formatInteger(row.totalprice, 0, 'COMMA')}">1,000</span></td>
            </tr>
            <tr>
                <th colspan="3">합계 :: <span th:text="${#numbers.formatInteger(monthTotal, 0, 'COMMA')}">total</span> 원</th>
            </tr>
        </tbody>
    </table>
</body>
</html>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script>

    $(document).ready(function () {

        var target='';

        $("input[name='companyprice']").focusout(function(){
           $(this).val(companypriceToString($(this).val())); 
        });

        $("input[name='companyprice']").focus(function(){

            $(this).val('');
           $(this).val(companypriceToString($(this).val())); 
        });
        $("input[name='myprice']").focusout(function(){
           $(this).val(mypriceToString($(this).val())); 
        });

        $("input[name='myprice']").focus(function(){

            $(this).val('');
           $(this).val(mypriceToString($(this).val())); 
        });
    });
    
    function save(param) {

        var companyprice = $("#companyprice" + param).val()

        $.ajax({
            type: "post",
            url: "/companypriceSave",
            data: {companyprice : companyprice, id : param },
            dataType: "text",
            success: function (response) {
                console.log(response);
                alert('저장 완료');
            },error : function (e) { 
                console.log(e);
              }
        });
        
      }

      	//천단위 콤마
	function companypriceToString(companyprice) {
	    return companyprice.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
    }


</script>